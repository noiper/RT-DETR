# Phase 1 Temporal RT-DETR Training Configuration for VIRAT Dataset

__include__: [
  '../dataset/virat_phase1_detection.yml',
  './include/optimizer.yml',
  './include/rtdetrv2_r50vd.yml',  # Include R50 base, then override to R18
]

# Override output directory
output_dir: './output/phase1_virat_r18vd'
summary_dir: './output/phase1_virat_r18vd/summary'

# Override to ResNet18
PResNet:
  depth: 18
  freeze_at: 0
  freeze_norm: True
  pretrained: True

# Override encoder for ResNet18 (smaller channels)
HybridEncoder:
  in_channels: [128, 256, 512]  # ResNet18 has smaller feature channels
  hidden_dim: 256
  expansion: 0.5  # Smaller expansion for lighter model

# Override decoder for ResNet18 (fewer layers)
RTDETRTransformerv2:
  num_layers: 3  # Use 3 layers instead of 6 for lighter model

# Override num_classes from dataset config
RTDETRTransformer:
  num_classes: ${num_classes}

# Phase 1 Temporal Training Specific Parameters
lambda_non_key: 0.5      # Loss weight for non-key frames: L = L_key + Î»*L_non_key

# Non-key frame decoder configuration
use_lightweight_decoder: False  # True: 1-layer decoder, False: 3-layer decoder (full)
reuse_queries: False            # True: reuse queries from key frame (experimental)
non_key_decoder_layers: 3       # Number of layers for non-key decoder (1 or 3)

# Training Settings
epoches: 50
clip_max_norm: 0.1

# Learning Rate Scheduler (override)
lr_scheduler:
  type: MultiStepLR
  milestones: [30, 40]
  gamma: 0.1

# Logging and Checkpointing
print_freq: 50
checkpoint_freq: 5

# Random seed
seed: 42